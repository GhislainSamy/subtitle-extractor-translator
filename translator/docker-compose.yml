version: '3.8'

services:
  subtitle-translator:
    image: subtitle-translator:latest
    container_name: subtitle-translator
    restart: unless-stopped
    volumes:
      # Adapter le chemin vers vos medias
      - /mnt/nas/media/films:/data
    environment:
      # Mode agent (true) ou exécution unique (false)
      - WATCH_MODE=true
      
      # Intervalle de vérification en secondes
      # 3600 = 1 heure
      # 21600 = 6 heures
      # 86400 = 24 heures
      - WATCH_INTERVAL=3600
      
      # Dossier source (monté dans le container)
      - SOURCE_FOLDER=/data

      # Fichier de log (optionnel)
      # Laissez commenté pour log console uniquement
      
      # Activer le log
      - LOG_FILE=/data/translator.log
      - LOG_FILE_MAX_SIZE_MB = 10  # Taille max par fichier (MB)
      - LOG_FILE_BACKUP_COUNT = 2  # Nombre de backups (total = backup + 1)

      # Configuration traduction
      - PAUSE_SECONDS=30
      - BATCH_SIZE=10
      - COOLDOWN_SECONDS=3600
      
      # Clés API Gemini (JSON array)
      - GEMINI_API_KEYS=["cle1","cle2"]
      
      # Modèles Gemini (JSON array)
      - GEMINI_MODELS=["gemini-3-flash-preview","gemini-2.5-flash"]

      # Variables de nettoyage (défaut: false = on garde tout)
      # Mettre à true pour activer le nettoyage automatique
      
      # Supprimer .fr.progress.json après traduction ?
      - DELETE_PROGRESS_AFTER=false
      
      # Supprimer .en.XXX.txt après traduction ?
      - DELETE_SOURCE_AFTER=false
      
      # Supprimer .to.srt.txt après traduction ?
      - DELETE_CONVERTED_AFTER=false