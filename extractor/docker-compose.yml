version: '3.8'

services:
  # =========================================
  # SUBTITLE EXTRACTOR (Standalone)
  # =========================================
  subtitle-extractor:
    image: ghcr.io/ghislainsamy/subtitle-extractor-translator/extractor:latest
    container_name: subtitle-extractor
    volumes:
      # Multi-folders: monter tous les dossiers √† scanner
      - /mnt/nas/media/films:/media/movies
      - /mnt/nas/media/series:/media/series
      - /mnt/nas/media/documentaires:/media/documentaries
      
      # Volume pour les logs (optionnel, peut aussi √™tre dans un des dossiers ci-dessus)
      - /docker/subtitle-extractor-translator/extractor/logs:/app/logs
    environment:
      # üÜï Multi-Folders Support
      # Configuration JSON array avec les 3 dossiers
      - SOURCE_FOLDERS=["/media/movies", "/media/series", "/media/documentaries"]
      
      # Mode agent continu
      - WATCH_MODE=true
      
      # Intervalle de v√©rification (secondes)
      # 3600 = 1h, 21600 = 6h, 86400 = 24h
      - WATCH_INTERVAL=3600
      
      # üìù Logs activ√©s avec rotation automatique
      - LOG_FILE=/app/logs/extractor.log
      - LOG_FILE_MAX_SIZE_MB=10        # Taille max par fichier (MB)
      - LOG_FILE_BACKUP_COUNT=2        # Nombre de backups (total = 3 fichiers)

      # ‚è±Ô∏è Timeouts optionnels (en secondes, laisser vide = pas de timeout)
      # - MKV_ANALYSIS_TIMEOUT=30      # Timeout pour mkvmerge -J (rapide, rarement n√©cessaire)
      # - MKV_EXTRACT_TIMEOUT=60       # Timeout pour mkvextract (utile si NAS lent)

    restart: unless-stopped